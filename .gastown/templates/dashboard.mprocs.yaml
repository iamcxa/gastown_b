# Gastown Dashboard - mprocs Configuration Template
#
# This template shows the format used by `gastown dashboard` to create
# an mprocs configuration for viewing all running convoys.
#
# mprocs is a TUI tool for running multiple processes.
# Install it with: brew install mprocs
#
# When you run `gastown dashboard`, it automatically generates a config
# like this based on your active convoys.
#
# Key design decisions:
# - mprocs only "attaches" to tmux sessions - closing mprocs leaves sessions running
# - Each convoy shows up as a separate mprocs pane with status icon
# - A "status" pane shows overall convoy status with Gastown branding
# - Uses bash loop for cross-platform compatibility (macOS doesn't have `watch`)
# - Pane names include convoy ID suffix to avoid duplicates

proc_list_width: 25

procs:
  # Status overview with Gastown header
  # Refreshes every 2 seconds using bash loop (cross-platform)
  "â›½ Status":
    shell: "bash -c 'while true; do clear; echo \"=== Gas Town Dashboard ===\"; echo; date \"+Last updated: %H:%M:%S\"; echo; gastown --status 2>/dev/null || echo \"No status available\"; sleep 2; done'"

  # Example convoy panes with status icons:
  #
  # ðŸŸ¢ = running (tmux session active)
  # ðŸŸ¡ = idle (convoy open but no session)
  # ðŸ”´ = stopped (convoy closed)
  #
  # Pane names include ID suffix (last 4 chars) for uniqueness

  "ðŸŸ¢ chess-game-c123":
    shell: "tmux attach -t gastown-abc123 2>/dev/null || echo 'Session: gastown-abc123'; echo 'Status: running'; echo 'Not attached. Press r to retry.'"

  "ðŸŸ¡ auth-feature-f456":
    shell: "tmux attach -t gastown-def456 2>/dev/null || echo 'Session: gastown-def456'; echo 'Status: idle'; echo 'Not attached. Press r to retry.'"

# When no convoys are active, a welcome pane is shown:
#
#   "ðŸ“‹ Welcome":
#     shell: "echo 'Welcome to Gas Town!'; echo; echo 'No active convoys found.'; ..."

# Keyboard shortcuts in mprocs:
# q    - quit dashboard (sessions keep running)
# j/k  - navigate process list
# s    - start process
# x    - stop process
# r    - restart process
# ?    - toggle help
